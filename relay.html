<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Googleアカウント選択</title>
</head>
<body>
  <h2>どのGoogleアカウントで開きますか？</h2>
  <button onclick="selectAccount(0)">アカウント 0</button>
  <button onclick="selectAccount(1)">アカウント 1</button>
  <button onclick="selectAccount(2)">アカウント 2</button>
  <button onclick="selectAccount(3)">アカウント 3</button>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      window.target = params.get("target");
    });

    function selectAccount(authuser) {
      if (!window.target) {
        alert("リンクが無効です");
        return;
      }

      try {
        const separator = window.target.includes("?") ? "&" : "?";
        const finalUrl = `${window.target}${separator}authuser=${authuser}`;
        location.replace(finalUrl); // Safari対策
      } catch (e) {
        alert("遷移に失敗しました: " + e.message);
      }
    }
  </script>
</body>
</html>
